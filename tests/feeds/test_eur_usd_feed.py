'''
EUR/USD DataFeed Tests
'''

import pytest

from telliot_feeds.feeds.eur_usd_feed import eur_usd_median_feed


@pytest.mark.asyncio
async def test_fetch_price():
    '''Fetch latest EUR/USD price'''
    (value, _) = await eur_usd_median_feed.source.fetch_new_datapoint()
    assert value > 0
    print(value)


def test_query_info():
    '''Test queryId and queryData construction'''
    q = eur_usd_median_feed.query
    exp_id = "2e0aa9e19f5c3e1d3e086b34fe90072b43889382f563e484e8e1e3588b19ef14"
    exp_data_hex = "00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000953706f745072696365000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000003657572000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000037573640000000000000000000000000000000000000000000000000000000000"  # noqa: E501

    assert q.query_id.hex() == exp_id
    assert q.query_data.hex() == exp_data_hex
